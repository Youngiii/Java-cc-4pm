<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis基础 | Java-cc-4pm</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="yee的学习笔记">
    
    <link rel="preload" href="/Java-cc-4pm/assets/css/0.styles.5f2da5a7.css" as="style"><link rel="preload" href="/Java-cc-4pm/assets/js/app.b4fa842c.js" as="script"><link rel="preload" href="/Java-cc-4pm/assets/js/2.eeb24f79.js" as="script"><link rel="preload" href="/Java-cc-4pm/assets/js/10.fcf2b3b2.js" as="script"><link rel="prefetch" href="/Java-cc-4pm/assets/js/11.b7afb852.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/12.da36e819.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/13.9449ceac.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/14.275ba392.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/15.f9855d75.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/3.b155d814.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/4.f876ad59.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/5.18c5236f.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/6.e86df8f9.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/7.3039bb28.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/8.b2c83167.js"><link rel="prefetch" href="/Java-cc-4pm/assets/js/9.6a457fac.js">
    <link rel="stylesheet" href="/Java-cc-4pm/assets/css/0.styles.5f2da5a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Java-cc-4pm/" class="home-link router-link-active"><!----> <span class="site-name">Java-cc-4pm</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Java-cc-4pm/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记本" class="dropdown-title"><span class="title">笔记本</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记本" class="mobile-dropdown-title"><span class="title">笔记本</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java-cc-4pm/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/Java-cc-4pm/Java/" class="nav-link router-link-active">
  Java
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Java-cc-4pm/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记本" class="dropdown-title"><span class="title">笔记本</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记本" class="mobile-dropdown-title"><span class="title">笔记本</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java-cc-4pm/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/Java-cc-4pm/Java/" class="nav-link router-link-active">
  Java
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>SpringBoot</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Java-cc-4pm/Java/SpringSecurity.html" class="sidebar-link">SpringSecurity入门</a></li><li><a href="/Java-cc-4pm/Java/认证授权.html" class="sidebar-link">认证授权</a></li><li><a href="/Java-cc-4pm/Java/MybatisPlus.html" class="sidebar-link">MybatisPlus</a></li><li><a href="/Java-cc-4pm/Java/Redis.html" aria-current="page" class="active sidebar-link">Redis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#redis基础" class="sidebar-link">Redis基础</a></li><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#redis-conf" class="sidebar-link">redis.conf</a></li><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#订阅发布" class="sidebar-link">订阅发布</a></li><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#主从复制" class="sidebar-link">主从复制</a></li><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#缓存" class="sidebar-link">缓存</a></li><li class="sidebar-sub-header"><a href="/Java-cc-4pm/Java/Redis.html#分布式集群" class="sidebar-link">分布式集群</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="redis基础"><a href="#redis基础" class="header-anchor">#</a> Redis基础</h2> <h3 id="数据结构"><a href="#数据结构" class="header-anchor">#</a> 数据结构</h3> <h4 id="string"><a href="#string" class="header-anchor">#</a> String</h4> <ul><li>计数器</li> <li>统计数</li> <li>对象缓存存储</li></ul> <h4 id="list"><a href="#list" class="header-anchor">#</a> List</h4> <ul><li><p>list命令都以L/R开头</p></li> <li><p>lpush [name] [v1] [v2] [v2]	(栈)</p></li> <li><p>lrange [name] 0 -1</p></li> <li><p>rpush [name] [v1]</p></li> <li><p>lpop</p></li> <li><p>rpop</p></li> <li><p>lindex [name] [index]	通过下表获取值</p></li> <li><p>llen 获取list长度</p></li> <li><p>lrem [listname] [nums] [elem] 移除nums个elem (精确匹配)</p></li> <li><p>ltrim [listname]  start stop  截取指定长度</p></li> <li><p>rpoplpush</p></li> <li><p>lset 将列表中指定下标的值替换为另外一个值，更新操作</p></li> <li><p>linsert   将某个具体的value插入到列把你中某个元素的前面或者后面！</p> <ul><li>他实际上是一个链表，before Node after ， left，right 都可以插入值</li> <li>如果key 不存在，创建新的链表</li> <li>如果key存在，新增内容</li> <li>如果移除了所有值，空链表，也代表不存在！</li> <li>在两边插入或者改动值，效率最高！ 中间元素，相对来说效率会低一点~</li> <li>消息排队!消息队列(Lpush Rpop),栈(Lpush Lpop)</li></ul></li></ul> <p>List阻塞队列</p> <h4 id="set-不能重复-无序"><a href="#set-不能重复-无序" class="header-anchor">#</a> Set(不能重复,无序)</h4> <ul><li>sadd key member[member ...]</li> <li>smembers key</li> <li>sismember key member</li> <li>scard myset</li> <li>srem key member</li> <li>srandmember key</li> <li>spop key</li> <li>smove source destination membe</li> <li>sinter key [key …] 查看一个集合的全部成员，该集合是所有给定集合的交集。	[共同好友,共同爱好,二度好友的实现]</li> <li>sunion key [key …] 查看一个集合的全部成员，该集合是所有给定集合的并集。</li> <li>sdiff key [key …] 查看所有给定 key 与第一个 key 的差集</li></ul> <h4 id="hash"><a href="#hash" class="header-anchor">#</a> Hash</h4> <p>hash变更的数据 user name age,尤其是是用户信息之类的，经常变动的信息！ hash 更适合于对象的 存储，String更加适合字符串存储！</p> <ul><li>hset key field value  set一个具体 key-vlaue</li> <li>hget key field</li> <li>hmset key field value</li> <li>hmget key field</li> <li>hgetall key</li> <li>hdel key field</li> <li>hlen key</li> <li>hexists key field</li> <li>hkeys key</li> <li>hvals key</li> <li>hincrby key field num</li> <li>hsetnx key field value</li> <li></li></ul> <h4 id="zset-有序集合"><a href="#zset-有序集合" class="header-anchor">#</a> Zset(有序集合)</h4> <ul><li>zadd key</li> <li>zrangebyscore key min max
1， 重要消息 2，带权重进行判断！ 排行榜应用实现，取Top N 测试！</li></ul> <h4 id="geospatial-地理位置"><a href="#geospatial-地理位置" class="header-anchor">#</a> geospatial(地理位置)</h4> <p>定位,
附近的人,(获得所有附近人的地址,定位),通过半径查询
打车计算距离</p> <ul><li>geoadd 添加位置
<ul><li>规则:两极无法添加,下载城市数据,直接通过java导入</li> <li>参数:key 值[经度,纬度 名称]</li></ul></li> <li>geodist 两个给定位置之间的距离</li> <li>geohash 返回一个或多个位置元素的 Geohash 表示</li> <li>geopos 获取指定城市的经纬度</li> <li>georadius  以给定的经纬度为中心,找出某一半径内的元素</li> <li>georadiusbymember  找出位于指定元素周围的其他元素</li></ul> <p>GEO 底层的实现原理其实就是 Zset！我们可以使用Zset命令来操作geo</p> <h4 id="hyperloglog"><a href="#hyperloglog" class="header-anchor">#</a> hyperloglog</h4> <p>基数---不重复的元素
优点：占用的内存是固定，2^64 不同的元素的技术，只需要废 12KB内存！如果要从内存角度来比较的 话 Hyperloglog 首选！<br>
页面的访问量(一个人访问网站多次,但还是算一个人)<br>
传统的方式: set 保存用户的id，然后就可以统计 set 中的元素数量作为标准判断<br>
这个方式如果保存大量的用户id，就会比较麻烦！我们的目的是为了计数，而不是保存用户id； 0.81% 错误率！ 统计UV任务，可以忽略不计的！<br>
如果允许容错，那么一定可以使用 Hyperloglog ！ 如果不允许容错，就使用 set 或者自己的数据类型即可!</p> <ul><li>pfadd key element</li> <li>pfcount key</li> <li>pfmerge destkey sourcekey</li></ul> <h4 id="bitmaps"><a href="#bitmaps" class="header-anchor">#</a> bitmaps</h4> <p>位存储
只有两个状态的都可以使用bitmaps,省内存操作二进制位来进行记录</p> <ul><li>setbit key offset value</li> <li>getbit key offset</li> <li>bitcount key</li></ul> <h3 id="命令"><a href="#命令" class="header-anchor">#</a> 命令</h3> <ul><li><p>可以用作数据库,缓存和消息中间件MQ</p></li> <li><p>默认有16个数据库</p></li> <li><p>默认使用第0个</p></li> <li><p>select切换</p></li> <li><p>dbsize 数据库大小</p></li> <li><p>set name young</p></li> <li><p>get name</p></li> <li><p>查看Key数据类型</p> <ul><li>type [keyname]</li></ul></li> <li><p>查看所有Key:</p> <ul><li>keys *</li></ul></li> <li><p>删除key</p> <ul><li>del [keyname] [数据库序号]</li></ul></li> <li><p>追加字符串</p> <ul><li>append [keyname] [&quot;string&quot;]</li> <li>不存在,相当于setkey</li></ul></li> <li><p>截取范围内字符串</p> <ul><li>getrange [keyname] [start] [end]</li></ul></li> <li><p>替换指定范围</p> <ul><li>setrange [keyname] [offset] [value]</li></ul></li> <li><p>字符串长度</p> <ul><li>strlen [keyname]</li></ul></li> <li><p>key对应的值自增1</p> <ul><li>incr [keyname]</li> <li>浏览量自增时使用</li></ul></li> <li><p>key对应的值自增/减n</p> <ul><li>incrby [keyname] [n]</li> <li>decrby [keyname] [n]</li></ul></li> <li><p>key对应的值自减1</p> <ul><li>decr [keyname]</li></ul></li> <li><p>移动某个Key到其他库</p> <ul><li>move [keyname] [db]</li></ul></li> <li><p>设置过期时间</p> <ul><li>expire [keyname] 10</li> <li>可用作单点登录设置过期时间</li> <li>setex [keyname] [time] [value] (set with expire)</li></ul></li> <li><p>不存在则设置</p> <ul><li>○ setnx (set if not exist) (分布式锁常用)</li></ul></li> <li><p>批量设置(原子性操作,要么一起成功,要么一起失败)</p> <ul><li>mset [k1] [v1] [k2] [v2]- ○ mget [k1] [k2]</li></ul></li> <li><p>查看剩余时间</p> <ul><li>ttl [keyname]</li></ul></li> <li><p>清空当前库</p> <ul><li>flushdb</li></ul></li> <li><p>清空所有库</p> <ul><li>flushall</li></ul></li> <li><p>设置对象</p> <ul><li>mset user:1:name zhangsan user:1:age:3</li></ul></li> <li><p>组合命令</p> <ul><li>getset(如果不存在,则返回nil,并设置;如果存在,获取原来的值,设置新的值)</li></ul></li> <li><p>redis是单线程的,6.0后支持多线程</p></li> <li><p>Redis的瓶颈是机器的内存和网络带宽</p></li></ul> <p>误区一：高性能服务器一定是多线程的<br>
误区二：多线程(产生CPU上下文的切换)一定比单线程效率高<br>
redis：将所有数据放到内存中,所以使用单线程操作效率高,多线程CPU上线文切换耗时高,对于内存系统来说,没有上下文切换,多次读写都是在一个CPU上.效率就是最高的.</p> <h3 id="事务操作"><a href="#事务操作" class="header-anchor">#</a> 事务操作</h3> <h3 id="线程模型"><a href="#线程模型" class="header-anchor">#</a> 线程模型</h3> <h3 id="内存管理"><a href="#内存管理" class="header-anchor">#</a> 内存管理</h3> <h3 id="读写策略"><a href="#读写策略" class="header-anchor">#</a> 读写策略</h3> <h3 id="持久化"><a href="#持久化" class="header-anchor">#</a> 持久化</h3> <h3 id="内存碎片"><a href="#内存碎片" class="header-anchor">#</a> 内存碎片</h3> <h2 id="redis-conf"><a href="#redis-conf" class="header-anchor">#</a> redis.conf</h2> <h2 id="订阅发布"><a href="#订阅发布" class="header-anchor">#</a> 订阅发布</h2> <h2 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> 主从复制</h2> <h2 id="缓存"><a href="#缓存" class="header-anchor">#</a> 缓存</h2> <h2 id="分布式集群"><a href="#分布式集群" class="header-anchor">#</a> 分布式集群</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Java-cc-4pm/Java/MybatisPlus.html" class="prev">
        MybatisPlus
      </a></span> <span class="next"><a href="/Java-cc-4pm/Java/Java基础.html">
        Java基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Java-cc-4pm/assets/js/app.b4fa842c.js" defer></script><script src="/Java-cc-4pm/assets/js/2.eeb24f79.js" defer></script><script src="/Java-cc-4pm/assets/js/10.fcf2b3b2.js" defer></script>
  </body>
</html>
